<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图生视频 - 萤火.AI</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            display: flex;
            flex-direction: column;
        }
        .upload-area {
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .upload-area:hover {
            border-color: #6366f1;
            background-color: #f9fafb;
        }
        .result-section {
            border-left: 1px solid #e5e7eb;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .spinner {
            animation: spin 1s linear infinite;
        }
        .video-control {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.5);
            padding: 8px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .video-wrapper:hover .video-control {
            opacity: 1;
        }
        
        /* 自定义开关样式 */
        #toggle-background.bg-blue-500 {
            border-color: #3b82f6;
        }
        
        #toggle-slider {
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        input:checked ~ #toggle-background {
            background-color: #3b82f6 !important;
            border-color: #3b82f6 !important;
        }
        
        input:focus ~ #toggle-background {
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
        }
        
        .main-container {
            display: flex;
            flex-direction: column;
            flex: 1;
        }
        
        .content-container {
            display: flex;
            flex-direction: column;
            flex: 1;
        }
        
        @media (min-width: 1024px) {
            .content-container {
                flex-direction: row;
            }
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="bg-white border-b border-gray-200 py-3 px-4 flex items-center justify-between shadow-sm">
        <div class="flex items-center">
            <a href="/" class="flex items-center">
                <span class="font-bold text-2xl text-indigo-600 mr-1">萤火<span class="inline-block w-2 h-2 bg-indigo-600 rounded-full"></span>AI</span>
                <span class="text-gray-500 text-sm ml-1">Yinghuo.Ai</span>
            </a>
        </div>
        <div class="flex items-center space-x-4">
            <a href="/" class="text-gray-600 hover:text-gray-900">
                <i class="ri-home-line mr-1"></i>
                <span>返回首页</span>
            </a>
            <a href="/credits.html" class="text-gray-600 hover:text-gray-900">
                <i class="ri-coin-line mr-1"></i>
                <span id="user-credits">积分: 加载中...</span>
            </a>
            <div class="relative" id="user-section">
                <button id="user-menu-btn" class="hidden flex items-center text-gray-700 hover:text-gray-900">
                    <i class="ri-user-3-line mr-1 text-lg"></i>
                    <span id="username-display">用户名</span>
                    <i class="ri-arrow-down-s-line ml-1"></i>
                </button>
                <a href="/login.html" id="login-btn" class="inline-flex items-center justify-center px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700">
                    登录/注册
                </a>
            </div>
        </div>
    </nav>

    <!-- 主内容区域 -->
    <div class="main-container">
        <div class="content-container">
            <!-- 左侧：上传图片和输入提示词 -->
            <div class="w-full lg:w-1/5 lg:min-w-[200px] border-b lg:border-b-0 lg:border-r border-gray-200 p-3">
                <h2 class="text-lg font-bold mb-2">上传图片</h2>
                
                <div id="upload-area" class="upload-area h-36 flex flex-col items-center justify-center mb-2 bg-gray-50 border border-dashed border-gray-300 rounded-md hover:border-indigo-500 hover:bg-gray-100 transition-colors">
                    <i class="ri-upload-cloud-line text-2xl text-gray-400 mb-1"></i>
                    <p class="text-gray-500 text-center text-xs px-2">点击或者拖动文件到这区域来上传</p>
                    <input type="file" id="image-upload" class="hidden" accept="image/*">
                </div>
                <p class="text-xs text-gray-500 mb-2 -mt-1">上传图片的大小不能大于30M</p>
                
                <div class="mb-2 lg:flex-grow flex flex-col">
                    <div class="flex justify-between items-center mb-1">
                        <h2 class="text-base font-medium">输入提示词</h2>
                        <a href="#" class="text-xs text-indigo-600 hover:text-indigo-800" id="prompt-guide-link">提示词详细教程</a>
                    </div>
                    <textarea id="prompt-input" style="height: 400px !important; min-height: 400px !important;" class="w-full min-h-[400px] h-[400px] p-3 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 mb-4 resize-none" placeholder="请输入提示词"></textarea>
                    
                    <!-- 智能改写开关 -->
                    <div class="flex items-center justify-between py-2 px-3 bg-blue-50 rounded-md mb-2">
                        <div class="flex items-center">
                            <span class="text-sm font-medium text-gray-700">是否开启提示词智能改写</span>
                        </div>
                        <label class="flex items-center cursor-pointer">
                            <div class="relative inline-block w-10 align-middle select-none">
                                <input type="checkbox" id="smart-rewrite-toggle" class="sr-only" checked>
                                <div id="toggle-background" class="block w-10 h-5 bg-gray-200 rounded-full border transition-colors duration-200 ease-in-out"></div>
                                <div id="toggle-slider" class="absolute top-0.5 left-0.5 bg-white w-4 h-4 rounded-full shadow transition-transform duration-200 ease-in-out"></div>
                            </div>
                        </label>
                    </div>
                    <p class="text-xs text-red-500 mb-3">开启后使用者在右侧输入的提示词进行智能改写，对于较短的提示词生成效果会提升明显，但生成结果会偏离原意。</p>
                </div>
            </div>
            
            <!-- 右侧：效果展示 -->
            <div class="w-full lg:w-4/5 lg:pl-6 lg:pr-4 py-6 result-section flex-grow">
                <h2 class="text-2xl font-bold mb-6 text-center">效果展示</h2>
                
                <p class="text-gray-700 mb-6 text-center">模特面带微笑，向前走两步，手保持自然，连衣裙也跟着步伐动</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-lg font-medium mb-3">上传图片：</h3>
                        <div id="original-image-container" class="h-64 bg-gray-100 rounded-md flex items-center justify-center overflow-hidden">
                            <img id="original-image" class="hidden max-w-full max-h-full object-contain" alt="上传的图片">
                            <p id="original-image-placeholder" class="text-gray-500 text-center px-4">上传图片后将在这里显示</p>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-medium mb-3">输出视频：</h3>
                        <div id="output-video-container" class="h-64 bg-gray-100 rounded-md flex items-center justify-center overflow-hidden">
                            <div id="video-wrapper" class="video-wrapper hidden w-full h-full relative">
                                <video id="output-video" class="w-full h-full object-contain" controls></video>
                            </div>
                            <p id="output-video-placeholder" class="text-gray-500 text-center px-4">视频生成后将在这里显示</p>
                        </div>
                    </div>
                </div>
                
                <!-- 填充剩余空间的内容 -->
                <div class="mt-8 bg-gray-50 p-4 rounded-lg flex-grow">
                    <h3 class="text-lg font-medium mb-3">使用说明</h3>
                    <div class="text-gray-600 text-sm">
                        <p class="mb-2">1. 上传一张清晰的图片（支持JPG、PNG等常见格式）</p>
                        <p class="mb-2">2. 输入您希望生成的视频动作描述，如"模特向左转身，微笑，然后挥手"</p>
                        <p class="mb-2">3. 根据需要选择是否开启智能改写功能</p>
                        <p class="mb-2">4. 点击"立即生成"按钮，等待视频生成（约3-10分钟）</p>
                        <p class="mb-4">5. 生成完成后，您可以直接观看或下载视频</p>
                        
                        <p class="font-medium">注意事项：</p>
                        <p class="mb-1">- 每次生成视频将消耗您账户中的积分</p>
                        <p class="mb-1">- 图片中的人物姿势越自然，生成效果越好</p>
                        <p class="mb-1">- 提示词越具体明确，生成的视频效果越理想</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 添加固定在底部的按钮 -->
    <div class="fixed bottom-0 left-0 w-full lg:w-1/5 p-3 bg-white border-t border-gray-200">
        <button id="generate-btn" class="w-full bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 flex items-center justify-center text-sm">
            <i class="ri-movie-2-line mr-1"></i>
            立即生成
        </button>
    </div>
    
    <!-- 加载中遮罩 -->
    <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-8 rounded-lg shadow-xl flex flex-col items-center">
            <div class="spinner rounded-full h-12 w-12 border-4 border-indigo-200 border-t-indigo-600 mb-4"></div>
            <p id="loading-message" class="text-lg font-medium">视频生成中，请耐心等待...</p>
            <p class="text-sm text-gray-500 mt-2">视频生成需要1-2分钟</p>
        </div>
    </div>

    <!-- 引用外部Javascript文件 -->
    <script src="/js/image-to-video.js"></script>
</body>
</html> 